<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
	PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="project5.team.TeamDao">
<!-- 회원 목록 리스트 -->
	<select id="getTeamList" resultType="team" parameterType="team">
		SELECT
		m.name AS name, m.auth AS auth,
		d.dname AS dname, m.email AS email,
		p.NAME AS projectname, mp.STATUS AS
		STATUS, mp.MEMBER_PROJECT_KEY AS memberprojectkey
		FROM MEMBER_PROJECT mp,
		MEMBER m, PROJECT p, DEPARTMENT d
		WHERE mp.STATUS LIKE '%'||#{status,
		jdbcType=VARCHAR}||'%'
		AND m.name IS NOT null
		AND mp.memberkey =
		m.MEMBERKEY
		AND mp.PROJECTKEY = p.PROJECTKEY
		AND mp.DEPTNO = d.DEPTNO
	</select>
	<!-- 회원 배정 목록 리스트 -->
	<select id="teamDetail" resultType="team" parameterType="team">
		SELECT
		m.name AS name, m.auth AS auth,
		d.dname AS dname, m.email AS email,
		p.NAME AS projectname, mp.STATUS AS
		STATUS, mp.MEMBER_PROJECT_KEY AS memberprojectkey
		FROM MEMBER_PROJECT mp,
		MEMBER m, PROJECT p, DEPARTMENT d
		WHERE mp.STATUS = #{status}
		AND
		p.PROJECTKEY = #{projectkey}
		AND m.name
		IS
		NOT null
		AND mp.memberkey =
		m.MEMBERKEY
		AND mp.PROJECTKEY =
		p.PROJECTKEY
		AND mp.DEPTNO = d.DEPTNO
	</select>
	<!-- 모달창 프로젝트 리스트 -->
	<select id="selectPrjList" parameterType="string"
		resultType="team">
		SELECT projectKey AS projectKey, name AS
		projectname
		FROM
		project
	</select>
	<!-- 부서 리스트 -->
	<select id="selectdptList" parameterType="string"
		resultType="team">
		SELECT deptno as deptno, dname
		FROM DEPARTMENT
	</select>
	<!-- 회원 리스트 -->
	<select id="selectMemList" parameterType="string"
		resultType="team">
		SELECT memberkey AS memberkey,name AS name
		FROM MEMBER
		WHERE
		id LIKE '%'||#{id,jdbcType=VARCHAR}||'%' AND pass LIKE
		'%'||#{pass,jdbcType=VARCHAR}||'%'
		AND name LIKE
		'%'||#{name,jdbcType=VARCHAR}||'%'
		ORDER BY memberkey asc
	</select>
	<!-- 프로젝트 배정 MEMBER_PROJECT VALUES (seq_team.nextval,#{projectkey},#{memberkey}, 
		#{deptno}, #{status}) -->
	<insert id="insertTeam" parameterType="team">
		INSERT INTO MEMBER_PROJECT
		values (seq_team.nextval,#{memberkey},,#{projectkey},#{deptno},#{status}))
	</insert>
	<update id="updateTeam" parameterType="team">
		UPDATE MEMBER
		SET status =
		#{status}
		WHERE PROJECTKEY = #{projectkey}
	</update>



</mapper>
